# Reads were imported into QIIME2 and the raw read counts for each sample were download from the qc-summmary.qzv

# These reads were used with the count of summary from the ASV output to create the bar plot. 

# Example

data <- read.csv("data.csv")
head(data)

library(reshape)
library(ggplot2)

melt <- melt(data)

# Get the summary stats from this data

tgc <- summarySE(melt, measurevar="value", groupvars=c("group"))

# Make figure
pdf("read_asv_count.pdf")
ggplot(tgc, aes(x=group, y=value)) + geom_bar(position=position_dodge(), stat="identity") + geom_errorbar(aes(ymin=value-se, ymax=value+se),  width=.2, position=position_dodge(.9))ax=value+se)
dev.off()

